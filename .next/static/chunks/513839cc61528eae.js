(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5531,46185,e=>{"use strict";var t=e.i(77732),r=e.i(85179),o=e.i(60217);let u=(0,r.createContext)(void 0),s="omi_guest_mode";function n({children:e}){let[o,n]=(0,r.useState)(!1);(0,r.useEffect)(()=>{try{let e=window.localStorage.getItem(s);n("true"===e)}catch(e){console.warn("Unable to read guest mode flag",e)}},[]);let l=(0,r.useCallback)(e=>{n(e);try{window.localStorage.setItem(s,e.toString())}catch(e){console.warn("Unable to persist guest mode flag",e)}},[]),a=(0,r.useCallback)(()=>{n(!1);try{window.localStorage.removeItem(s)}catch(e){console.warn("Unable to clear guest mode flag",e)}},[]),i=(0,r.useMemo)(()=>({isGuestMode:o,setGuestMode:l,clearGuestMode:a}),[a,o,l]);return(0,t.jsx)(u.Provider,{value:i,children:e})}function l(){let e=(0,r.useContext)(u);if(!e)throw Error("useGuestMode must be used within GuestModeProvider");return e}e.s(["GuestModeProvider",()=>n,"useGuestMode",()=>l],46185);let a=(0,r.createContext)(void 0);function i({children:e}){let u=(0,r.useMemo)(()=>(0,o.getBrowserSupabaseClient)(),[]),{isGuestMode:s}=l(),[n,i]=(0,r.useState)(null),[c,d]=(0,r.useState)(null),[h,b]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=null;return s?(i(null),d(null),b(!1),()=>{e?.data.subscription.unsubscribe()}):(u.auth.getSession().then(({data:e})=>{i(e.session),d(e.session?.user??null)}).finally(()=>b(!1)),e=u.auth.onAuthStateChange((e,t)=>{i(t),d(t?.user??null)}),()=>{e?.data.subscription.unsubscribe()})},[s,u]);let g=(0,r.useMemo)(()=>({session:n,user:c,loading:h}),[h,n,c]);return(0,t.jsx)(a.Provider,{value:g,children:e})}function c(){let e=(0,r.useContext)(a);if(!e)throw Error("useAuth must be used within AuthProvider");return e}e.s(["AuthProvider",()=>i,"useAuth",()=>c],5531)}]);